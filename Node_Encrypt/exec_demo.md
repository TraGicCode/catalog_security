<!SLIDE>
# Manage secrets in `exec` resources.
## Using the `puppet node decrypt` command.

See the environment variable:

    @@@ Shell execute
    ssh root@demo 'echo $SECRET'

See the decrypted text:

    @@@ Shell execute
    ssh root@demo puppet node decrypt --env SECRET

Encrypt some text on the Master:

    @@@ Shell code_wrap execute
    ssh root@master 'puppet node encrypt -t demo.puppetlabs.vm "and your father smelt of elderberries"'

~~~SECTION:handouts~~~
Results:

    @@@ Shell code_wrap
    root@demo:~ # echo $SECRET
    -----BEGIN PKCS7----- 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 zuiTIT+leFdYCcoDOIy4yg== -----END PKCS7-----
    root@demo:~ # puppet node decrypt --env SECRET
    and your father smelt of elderberries

.break

    @@@ Shell code_wrap
    root@master:~ # puppet node encrypt -t demo.puppetlabs.vm 'and your father smelt of elderberries'
    -----BEGIN PKCS7-----
    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
    zuiTIT+leFdYCcoDOIy4yg==
    -----END PKCS7-----

~~~ENDSECTION~~~
